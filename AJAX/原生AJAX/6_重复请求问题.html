<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>重复请求问题</title>
</head>
<body>
<button>点击发送请求</button>
<button>点击取消请求</button>
<script type="text/javascript">
    const btns = document.getElementsByTagName('button')
    let xhr = null
    let isSending = false
    btns[0].addEventListener('click',function(){
        if(isSending){
            xhr.abort()
        }
        xhr = new XMLHttpRequest()
        isSending = true
        xhr.open('GET','http://127.0.0.1:8000/timeout')
        xhr.send()
        xhr.onreadystatechange = function(){
            if(xhr.readyState === 4){
                isSending = false
            }
        }
    })

    // abort()函数取消请求
    btns[1].addEventListener('click',function(){
        xhr.abort()
    })
</script>
</body>
</html>